<ScreenWithNavigation@BoxLayout>:
    MDBottomNavigation:
        MDBottomNavigationItem:
            name: 'screen1'
            text: 'Welcome'
            icon: 'home'
            on_tab_release: app.root.current = "welcome"

        MDBottomNavigationItem:
            name: 'screen2'
            text: 'Mi Stock'
            icon: 'list-box-outline'
            on_tab_release: 
                app.view_stock()
                app.root.current = "view_stock"

        MDBottomNavigationItem:
            name: 'screen3'
            text: 'Añadir Stock'
            icon: 'plus-box'
            on_tab_release: app.root.current = "add_stock"

        MDBottomNavigationItem:
            name: 'screen4'
            text: 'Pantalla 4'
            icon: 'help'
            on_tab_release: app.root.current = self.name

ScreenManager:
    LoginScreen:
    RegisterScreen:
    WelcomeScreen:
    AddStockScreen:
    ViewStockScreen:

<LoginScreen>:
    name: "login"
    canvas.before:
        Color:
            rgba: 212/255, 230/255, 247/255, 1  
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 20
        Image:
            source: 'logo.png'
            size_hint: (None, None)
            size: (300, 300)
            pos_hint: {"center_x": 0.5, "center_y": 0.5}  # Centering the image

        MDLabel:
            text: "Iniciar Sesión"
            halign: 'center'
            theme_text_color: "Primary"
            font_style: "H5"

        MDTextField:
            id: username
            hint_text: "Nombre de usuario"
            required: True

        MDTextField:
            id: password
            hint_text: "Contraseña"
            password: True
            required: True

        MDRaisedButton:
            text: "Iniciar Sesión"
            pos_hint: {"center_x": 0.5}
            on_release: app.login(username.text, password.text)

        MDTextButton:
            text: "Crear una cuenta"
            pos_hint: {"center_x": 0.5}
            on_release: app.root.current = "register"

<RegisterScreen>:
    name: "register"
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 20

        MDLabel:
            text: "Registrar"
            halign: 'center'
            theme_text_color: "Primary"
            font_style: "H5"

        MDTextField:
            id: reg_username
            hint_text: "Nombre de usuario"
            required: True

        MDTextField:
            id: reg_password
            hint_text: "Contraseña"
            password: True
            required: True

        MDTextField:
            id: confirm_password
            hint_text: "Confirmar Contraseña"
            password: True
            required: True

        MDRaisedButton:
            text: "Registrar"
            pos_hint: {"center_x": 0.5}
            on_release: app.register(reg_username.text, reg_password.text, confirm_password.text)

        MDTextButton:
            text: "Ya tienes una cuenta? Inicia sesión"
            pos_hint: {"center_x": 0.5}
            on_release: app.root.current = "login"

<WelcomeScreen>:
    name: "welcome"
    ScreenWithNavigation:
    BoxLayout:
        orientation: 'vertical'
        padding: [20, 100]
        spacing: 20
        MDLabel:
            text: "¡Bienvenido a Your Stock Manager!"
            halign: 'center'
            theme_text_color: "Primary"
            font_style: "H5"
        Image:
            source: 'logo.png'
            size_hint: (None, None)
            size: (300, 300)
            pos_hint: {"center_x": 0.5, "center_y": 0.5}  # Centering the image
        #MDRaisedButton:
            #text: "Mostrar Snackbar"
            #pos_hint: {"center_x": 0.5}
            #on_release: app.show_snackbar("¡Betis hasta la muerte!")

        MDRaisedButton:
            text: "Cerrar Sesión"
            pos_hint: {"center_x": 0.5}
            on_release: app.logout()

        # MDRaisedButton:
        #     text: "Añadir Stock"
        #     pos_hint: {"center_x": 0.5}
        #     on_release: app.root.current = "add_stock"

        # MDRaisedButton:
        #     text: "Ver Stock"
        #     pos_hint: {"center_x": 0.5}
        #     on_release: 
        #         app.view_stock()
        #         app.root.current = "view_stock"

<AddStockScreen>:
    name: "add_stock"
    ScreenWithNavigation:
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 20

        MDLabel:
            text: "Añadir Stock"
            halign: 'center'
            theme_text_color: "Primary"
            font_style: "H5"

        MDTextField:
            id: item_name
            hint_text: "Nombre del producto"
            required: True

        MDTextField:
            id: item_quantity
            hint_text: "Cantidad"
            required: True

        MDRaisedButton:
            text: "Añadir"
            pos_hint: {"center_x": 0.5}
            on_release: app.add_stock(item_name.text, item_quantity.text)
        
        BoxLayout:
            size_hint_y: 0.3

<ViewStockScreen>:
    name: "view_stock"
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 20

        MDLabel:
            text: "Ver Stock"
            halign: 'center'
            theme_text_color: "Primary"
            font_style: "H5"

        ScrollView:
            MDList:
                id: stock_list

        MDTextButton:
            text: "Volver"
            pos_hint: {"center_x": 0.5}
            on_release: app.root.current = "welcome"
